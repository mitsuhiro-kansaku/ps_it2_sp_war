<!doctype html>
<html LANG="ja">
<head>
<title>#customSpringMessage('DELIV_CHECK_INFO')</title><!--納期確認情報-->
<meta http-equiv="Content-type" content="text/html; charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Content-script-type" content="text/javascript">
<link id="CSS_FONT" rel="stylesheet" href="../../include/FontS.css" type="text/css">
<link rel="stylesheet" href="../../include/Layout.css" type="text/css">
<link rel="stylesheet" href="../../include/Color.css" type="text/css">
<link rel="stylesheet" href="../../include/searchbox.css" type="text/css">
<script language="javascript" type="text/javascript" src="../../include/jquery-1.7.2.min.js"></script>
<script language="javascript" type="text/javascript" src="../../include/jquery.tablefix.js"></script>
<script language="javascript" TYPE="text/javascript" src="../../include/common.js"></script>
<script language="javascript" TYPE="text/javascript" src="../../include/check.js"></script>
<script language="javascript" TYPE="text/javascript" src="../../include/date.js"></script>
<script language="javascript" TYPE="text/javascript" src="../../include/tablesort.js"></script>
<script language="javascript" TYPE="text/javascript">
<!--
#set($searchCondition=$delivCheckSearchCondition)
#set($checkBoxsIsSelectMessageParam = ["#customSpringMessage('QUOT_REQ_INFO')"])
#parse("./common/common_js.vm")
var oldPage;
function onLoad() {
    parentButtonEnable();
    #if($!delivCheckList.delivCheckListItemList.size()!=0)
        function  block(){
            parent.document.getElementById('none').style.display='';
        }
        block();
    #else
        function none(){
            parent.document.getElementById('none').style.display='none';
        }
        none();
    #end
    TableSort.init();
    dataLoadHasPage();
    paging();
    var alertMessage = "$!alertMessage";
    if (alertMessage != ""){
        buttonUsableForList(alertMessage);
        alert(alertMessage);
    }

    var isSuccess = '#jsEscape($!isSuccess)';
    if(isSuccess == 'true'){
        #set( $quotReqParam1 = ["#customSpringMessage('DELIV_CHECK_INFO')"])
        alert('#customMessageArgs("I002",$quotReqParam1)');
    }

    var errorMsg = "$!errorMessage";
    if (errorMsg != ""){
        return;
    }
}

function update() {
    var count=0;
    #foreach($delivCheckListItem in $!delivCheckList.delivCheckListItemList)
        var checkName = "delivCheckListItemList["+$velocityCount+"].delivMngIdentify.checkStatus";
        if(getObj(checkName)!=null && getObj(checkName).value=="1"){
            count++;
        }
    #end
    if(count==0){
        #set( $mQuotReply = "#customSpringMessage('DELIV_CHECK_INFO')" )
        ## 2013.02.07 DEL DAIKO_WANG
        ## alert('#customMessageArgs("I010",[$mQuotReply])')
        ## 2013.02.07 ADD DAIKO_WANG
        alert("#nothingSelectedMessage()");
    }else{
        #set( $quotReqParam2 = ["#customSpringMessage('DELIV_CHECK_INFO')","#customSpringMessage('NEW_CHECK')"])
        if( !confirm("#customMessageArgs("W001",$quotReqParam2)") ) {
            return;
        }
        parentButtonDisable();
        getObj("BodyForm").action = "${flowExecutionUrl}&_eventId=newConfirm";
        getObj('BodyForm').submit();
    }
}

function allupdate(){
    if( !confirm("#customMessageArgs("W001",["#customSpringMessage('DELIV_CHECK_INFO')","#customSpringMessage('NEW_ALL_COUNT_CHECK')"])") ) {
        return;
    }
    parentButtonDisable();
    iframeChange("${flowExecutionUrl}&_eventId=newConfirmAll");
}

function openDetail(vmdelivMngSeq,vmlastUpdDate) {
    poppage('${flowExecutionUrl}&_eventId=detail&&delivMngSeq=' + vmdelivMngSeq + '&&lastUpdDate=' + vmlastUpdDate,'DETAIL','800','700');
}

//chkHead
$(function(){
    $(document).delegate('#ParentCheck','change',function() {
        var chk = $(this).prop("checked");
        var status = 0;
        $("input:[type=checkbox][name^=status_]").prop("checked",chk)
    #foreach ( $delivCheckListItem in $delivCheckList.delivCheckListItemList )
        #if($delivCheckListItem.status != '1')
            if(chk){
                $("tr:[id=Row_" + $velocityCount + "]").css("backgroundColor","#ff9");
                status = 1;
            }else{
                #if ($velocityCount % 2 != 0)
                    $("tr:[id=Row_" + $velocityCount + "]").css("backgroundColor","#fff");
                #else
                    $("tr:[id=Row_" + $velocityCount + "]").css("backgroundColor","#dce4ef");
                #end
            }
            $("input:[type=hidden][id^='delivCheckListItemList[" + $velocityCount + "]'][id$=checkStatus]").val(status);
        #end
    #end
    });
});

//check one
function chkData(obj, index){
    var status = 0;
    if(obj.checked == true){
        $("tr:[id=Row_" + index + "]").css("backgroundColor","#ff9");
        status = 1;
    }else{
        if (index % 2 != 0) {
            $("tr:[id=Row_" + index + "]").css("backgroundColor","#fff");
        } else {
            $("tr:[id=Row_" + index + "]").css("backgroundColor","#dce4ef");
        }
    }
    $("input:[type=hidden][id^='delivCheckListItemList[" + index + "]'][id$=checkStatus]").val(status);
}
// いずれかの選択チェックボックスがONの場合
function pageChange(pageNnm, pageno){
    var count=0;
    #foreach($delivCheckListItem in $!delivCheckList.delivCheckListItemList)
        var checkName = "delivCheckListItemList["+$velocityCount+"].delivMngIdentify.checkStatus";
        if(getObj(checkName)!=null && getObj(checkName).value=="1"){
            count++;
        }
    #end
    if(count!=0){
       if( !confirm("#customMessageArgs("W004","")") ) {
           parent.document.Body.PageNo.value = oldPage;
           return false;
       }
    }
    parent.iframeChange('${flowExecutionUrl}&_eventId=page','pageNow',pageNnm);
    return true;
}
function paging(){
    #if($searchCondition)
        parent.setText("COUNT","#jsEscape($!searchCondition.searchCondition.page.totalRows)");
        parent.setText("PAGECOUNT","#jsEscape($!searchCondition.searchCondition.page.totalPages)");

        parent.document.Body.PageNo.options.length = "#jsEscape($!searchCondition.searchCondition.page.totalPages)";
        for(i=1; i<=parent.document.Body.PageNo.options.length; i++) {
            parent.document.Body.PageNo.options[i-1] = new Option(i,i);
        }
        var pageNow=parseInt("#jsEscape($!searchCondition.searchCondition.page.pageNow)");
        parent.document.Body.PageNo.selectedIndex = pageNow-1;
        parent.document.Body.PageNo.onchange= new Function(" var num=parent.document.Body.PageNo.selectedIndex+1;pageChange(num)");

        #if($!searchCondition.searchCondition.page.hasPreviousPage=="true")
            parent.document.Body.PageFirst.style.display="none";
            parent.document.Body.PageFirstOn.style.display="";
            parent.document.Body.PageFirstOn.onclick = new Function("pageChange(1)");
            parent.document.Body.PagePrev.style.display="none";
            parent.document.Body.PagePrevOn.style.display="";
            parent.document.Body.PagePrevOn.onclick = new Function("var num=parseInt('#jsEscape($!searchCondition.searchCondition.page.pageNow)')-1;pageChange(num)");
        #else
            parent.document.Body.PageFirst.style.display="";
            parent.document.Body.PageFirstOn.style.display="none";
            parent.document.Body.PagePrev.style.display="";
            parent.document.Body.PagePrevOn.style.display="none";
        #end

        #if($!searchCondition.searchCondition.page.hasNextPage=="true")
            parent.document.Body.PageNext.style.display="none";
            parent.document.Body.PageNextOn.style.display="";
            parent.document.Body.PageNextOn.onclick = new Function("var num=parseInt('#jsEscape($!searchCondition.searchCondition.page.pageNow)')+1;pageChange(num)");
            parent.document.Body.PageLast.style.display="none";
            parent.document.Body.PageLastOn.style.display="";
            parent.document.Body.PageLastOn.onclick = new Function("pageChange(#jsEscape($!{searchCondition.searchCondition.page.totalPages}))");
        #else
            parent.document.Body.PageNext.style.display="";
            parent.document.Body.PageNextOn.style.display="none";
            parent.document.Body.PageLast.style.display="";
            parent.document.Body.PageLastOn.style.display="none";
        #end
         ## +++++ 強化-01448-000 2013/05/27 ADD SBO_lichao START +++++
         oldPage = parseInt(parent.document.Body.PageNo.value);
         ## +++++ 強化-01448-000 2013/05/27 ADD SBO_lichao -END- +++++
    #end
}
//-->
</script>

</head>
<body id="BODY" class="DataArea" onload="onLoad();setTablefix('#TABLEFIX', 1, 3);">
#if($!errorMessage && $!errorMessage!="")
<div id="error" name="error" class="error">
    $!errorMessage
</div>
#end
<form name="Body" id="BodyForm" method="post">
#foreach($delivCheckListItem in $!delivCheckList.delivCheckListItemList)
    #customFormHiddenInput("delivCheckListItemList[$velocityCount].delivMngIdentify.checkStatus" "")
#end
<table id="TABLEFIX" class="ListArea" width=" 100% ">
    <thead>
    #if($!delivCheckList.delivCheckListItemList.size()!=0)
        <tr id="Header">
            <th class="BoxHeaderCenter FontSmall">No.</th>
            <th class="BoxHeaderCenter FontSmall">#customSpringMessage('DETAIL')</th>
            <th id="CheckCol_H" label="chk" class="BoxHeaderCenter FontSmall">
                <input name="ParentCheck" id="ParentCheck" type="checkbox"><!--全選択/全選択解除-->
            </th>
            <th label="img" class="BoxHeaderCenter FontSmall">
                <img border="0" src="../../image/mrkAttache.gif">
            </th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_DLV_EST.DELIV_VERSION"
                onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_DLV_EST.DELIV_VERSION')">
                #customSpringMessage('REVISION_NUMBER')<!--履歴番号--></th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_DLV_EST.DPO_FLG"
                onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_DLV_EST.DPO_FLG')">
                #customSpringMessage('STATUS')<!--状態--></th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_DLV_EST.ORDER_NO"
                onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_DLV_EST.ORDER_NO')">
                #customSpringMessage('ORDER_NO')<!--注文番号--></th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_ORDER.BUYER_COMPANY_NAME"
                onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_ORDER.BUYER_COMPANY_NAME')">
                #customSpringMessage('BUYER_COMPANY')<!--発注企業--></th>
            <th class="BoxHeaderCenter FontSmall">
                #customSpringMessage('BUYER_COMMENT_TO_SUP')<!--発注企業コメント--></th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_ORDER.ITEM_NAME"
                onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_ORDER.ITEM_NAME')">
                #customSpringMessage('ITEM_NAME')<!--品名--></th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_ORDER.CUST_ITEM_CD"
                onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_ORDER.CUST_ITEM_CD')">
                #customSpringMessage('ITEM_CD')<!--品名コード--></th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_ORDER.KATASHIKI"
                onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_ORDER.KATASHIKI')">
                #customSpringMessage('KATASHIKI')<!--型式--></th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_DLV_EST.INQ_DATE"
                onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_DLV_EST.INQ_DATE')">
                #customSpringMessage('DELIV_CHECK_DATE')<!--納期確認日--></th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_DLV_EST.RESP_LIMIT_DATE"
                onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_DLV_EST.RESP_LIMIT_DATE')">
                #customSpringMessage('DELIV_RCV_LIMIT')<!--納期回答期限--></th>
            <th class="BoxHeaderCenter FontSmall">
                #customSpringMessage('CHECK_DELIV_DATE')<!--確認納期--></th>
            ## ----- 2013/03/22 DEL DAIKO_TAKEDA START
            #*
            <th label="num" class="BoxHeaderCenter FontSmall" id="S_ORDER.ORDER_VOL"
                onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_ORDER.ORDER_VOL')">
                #customSpringMessage('ORDER_VOL')<!--注文数量--></th>
            *#
            ## ----- 2013/03/22 DEL DAIKO_TAKEDA -END-
            ## +++++ 2013/03/22 ADD DAIKO_TAKEDA START
            <th class="BoxHeaderCenter FontSmall" id="S_ORDER.ORDER_VOL">
                #customSpringMessage('ORDER_VOL')<!--注文数量--></th>
            ## +++++ 2013/03/22 ADD DAIKO_TAKEDA -END-
            <th label="num" class="BoxHeaderCenter FontSmall" id="S_ORDER.UNIT_NAME"
                onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_ORDER.UNIT_NAME')">
                #customSpringMessage('EDI_ORDER_UNIT')<!--注文単位--></th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_ORDER.CURRENCY_CD"
                onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_ORDER.CURRENCY_CD')">
                #customSpringMessage('CURRENCY_CD')<!--通貨コード--></th>
            ## ----- 2013/03/22 DEL DAIKO_TAKEDA START
            #*
            <th label="num" class="BoxHeaderCenter FontSmall" id="S_ORDER.ORDER_AMOUNT"
                onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_ORDER.ORDER_AMOUNT')">
                #customSpringMessage('ORDER_AMOUNT')<!--注文金額--></th>
            *#
            ## ----- 2013/03/22 DEL DAIKO_TAKEDA -END-
            ## +++++ 2013/03/22 ADD DAIKO_TAKEDA START
            ## 2013.03.29 DEL DAIKO_WANG START
            ##<th class="BoxHeaderCenter FontSmall" id="S_ORDER.ORDER_AMOUNT">
            ##    #customSpringMessage('ORDER_AMOUNT')<!--注文金額--></th>
            ## 2013.03.29 DEL DAIKO_WANG -END-
            ## +++++ 2013/03/22 ADD DAIKO_TAKEDA -END-
        </tr>
    </thead>

    <tbody>
    #foreach($delivCheckListItem in $!delivCheckList.delivCheckListItemList)
    #if($velocityCount % 2 == 0)
        <tr id="Row_$velocityCount" bgcolor="#dce4ef">
    #else
        <tr id="Row_$velocityCount" bgcolor="#ffffff">
    #end
            <td class="BoxDetailCenter FontList">#set( $no = $velocityCount + 1 )$no</td>
            <td class="BoxDetailCenter">
                <img id="DetailButton_0" class="Icon" src="../../image/btnDetailDisp.gif" onclick="openDetail('#jsEscapeInHTML($delivCheckListItem.delivMngIdentify.delivMngSeq)','#jsEscapeInHTML($!delivCheckListItem.delivMngIdentify.lastUpdDate)');"><!--詳細を表示します-->
            </td>
            <td id="CheckCol_0" class="BoxDetailCenter">
                #if($delivCheckListItem.status != '1')
                    <input type="checkbox" onclick="chkData(this,$velocityCount)" class="Icon" name="status_$velocityCount">
                #end
            </td>
            <td CLASS="BoxDetailCenter">
                #if("$delivCheckListItem.attachFlg" != "")
                <IMG BORDER="0" src="../../image/mrkAttache.gif">
                #end
            </td>
            <td class="BoxDetailCenter FontList">
                #* ----- 2013/02/04 DEL DAIKO_YAMAGUCHI
                #if($!delivCheckListItem.revisionNumber !='1')
                *#
                #out($!delivCheckListItem.revisionNumber)
                #* ----- 2013/02/04 DEL DAIKO_YAMAGUCHI
                #end
                *#
            </td><!--履歴番号-->
            <td class="BoxDetailCenter FontMiniAnkBold">#out($!delivCheckListItem.status_PageValue)</td><!--状態-->
            <td class="BoxDetailLeft FontSlipNo">#out($!delivCheckListItem.orderNo)</td><!--注文番号-->
            <td class="BoxDetailLeft FontList">#out($!delivCheckListItem.buyerCompany)</td><!--発注企業-->
            <td class="BoxDetailLeft FontList">#out($!delivCheckListItem.buyerCompanyComment)</td><!--発注企業コメント-->
            <td class="BoxDetailLeft FontList">#out($!delivCheckListItem.itemName)</td><!--品名-->
            <td class="BoxDetailLeft FontList">#out($!delivCheckListItem.itemCd)</td><!--品名コード-->
            <td class="BoxDetailLeft FontList">#out($!delivCheckListItem.katashiki)</td><!--型式-->
            <td class="BoxDetailCenter FontList">#out($!delivCheckListItem.delivCheckDate.dateOfymdFormat)</td><!--納期確認日-->
            <td class="BoxDetailCenter FontList">#out($!delivCheckListItem.respLimitDate.dateOfymdFormat)</td><!--納期回答期限-->
            <td class="BoxDetailCenter FontList">
                #foreach($!checkDelivDate in $!delivCheckListItem.checkDelivDateList)
                #out($!checkDelivDate.checkDelivDate.dateOfymdFormat) <br>
                #end
            </td><!--確認納期-->
            <td class="BoxDetailRight FontList" nowrap><!--注文数量-->
                <span id="FontSmallAnk_$velocityCount">
                    ## ----- 2013/03/22 DEL DAIKO_TAKEDA
                    ## #out($!delivCheckListItem.orderVol.volFormat)
                    ## +++++ 2013/03/22 ADD DAIKO_TAKEDA
                    #out($!delivCheckListItem.originVol.volFormat)
                </span>
            </td>
            <td class="BoxDetailCenter FontList">#out($!delivCheckListItem.orderUnit)</td><!--注文単位-->
            <td class="BoxDetailCenter FontList">#out($!delivCheckListItem.currencyCd)</td><!--通貨コード-->

            ## 2013.03.29 DEL DAIKO_WANG START
            #*
            <!--注文金額-->
            #if ($!delivCheckListItem.orderAmount.moneyDisp)
            <td class="BoxDetailRight FontCurrSmall" nowrap>
                <span id="FontCurrSmall_$velocityCount">
                    ## ----- 2013/03/22 DEL DAIKO_TAKEDA
                    ## #out($!delivCheckListItem.orderAmount.amountMarkDispForSP)
                    ## +++++ 2013/03/22 ADD DAIKO_TAKEDA
                    #out($!delivCheckListItem.originAmount.amountMarkDispForSP)
                    #if($!delivCheckListItem.unitPriceInd == '0')
                        <BR><font class="FontMini" color=red>【#customSpringMessage('PROV_PRICE')】</font>
                    #end
                </span>
            </td>
            #else
            <td class="BoxDetailCenter FontCurrSmall" nowrap>
                ## ----- 2013/03/22 DEL DAIKO_TAKEDA
                ## #out($!delivCheckListItem.orderAmount.amountMarkDispForSP)
                ## +++++ 2013/03/22 ADD DAIKO_TAKEDA
                #out($!delivCheckListItem.originAmount.amountMarkDispForSP)
            </td>
            #end
            *#
            ## 2013.03.29 DEL DAIKO_WANG -END-
        </tr>
        #end
    </tbody>
    #end
</table>
<table id="WAIT" class="NoBorder" style="display:none;width:100%;">
    <tr>
        <td style="text-align:center;">
        <br><br>
            <img src="../../image/wait.gif">
            <br>
            <span class="FontMini">
                <br>
            </span>
        </td>
    </tr>
</table>
<input type="hidden" name="rowno">
</form>
</body>

</html>
