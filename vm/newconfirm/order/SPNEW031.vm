<!doctype html>
<html LANG="ja">
<head>
<title>#customSpringMessage('ORDER_INFO')
#if($!infoCd =='0502')
    (#customSpringMessage('CONFIRMED_ORDER'))
#elseif($!infoCd=='0503')
    (#customSpringMessage('ORDER_MODIFY'))
#elseif($!infoCd=='0504')
    (#customSpringMessage('ORDER_CANCEL'))
#elseif($!infoCd=='0505')
    (#customSpringMessage('DISCONTINUED_ORDER'))
#end
</title>
<meta http-equiv="Content-type" content="text/html; charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Content-script-type" content="text/javascript">
<link id="CSS_FONT" rel="stylesheet" href="../../include/FontS.css" type="text/css">
<link rel="stylesheet" href="../../include/Layout.css" type="text/css">
<link rel="stylesheet" href="../../include/Color.css" type="text/css">
<link rel="stylesheet" href="../../include/searchbox.css" type="text/css">
<script language="javascript" TYPE="text/javascript" src="../../include/common.js"></script>
<script language="javascript" TYPE="text/javascript" src="../../include/check.js"></script>
<script language="javascript" TYPE="text/javascript" src="../../include/date.js"></script>
<script language="javascript" TYPE="text/javascript" src="../../include/tablesort.js"></script>
<script language="javascript" type="text/javascript" src="../../include/jquery-1.7.2.min.js"></script>
<script language="javascript" type="text/javascript" src="../../include/jquery.tablefix.js"></script>
<script language="javascript" TYPE="text/javascript">
<!--
#set($searchCondition=$orderInfoSearchCondition)

#parse("./common/common_js.vm")

function downloadFileCooperation(filename, file, idx) {
    iframeChange("${flowExecutionUrl}&_eventId=downloadCooperation", 'filename', filename, 'file', file, 'idx', idx);
}
var checkInfo;
var oldPage;
function onLoad(){
    parentButtonEnable();
    #if($orderList.orderInfoItemList.size()!=0)
        function  block(){
            parent.document.getElementById('none').style.display='';
        }
        block();
    #else
        function none(){
            parent.document.getElementById('none').style.display='none';
        }
        none();
    #end
    TableSort.init();
    dataLoadHasPage();
    checkInfo = parent.listCheckInfo();
    var alertMessage = "$!alertMessage";
    if (alertMessage != ""){
        buttonUsableForList(alertMessage);
        alert(alertMessage);
    }
    paging();

    var isSuccess = '#jsEscape($!isSuccess)';
    if(isSuccess == 'true'){
        #set( $orderInfoParam1 = ["#customSpringMessage('ORDER_INFO')"])
        alert('#customMessageArgs("I002",$orderInfoParam1)');
    }

    var errorMsg = "$!errorMessage";
    if (errorMsg != ""){
        return;
    }
    var isShowDetail = '#jsEscape($!isShowDetail)';
    if(isShowDetail == 'true'){
        parent.poppage('${flowExecutionUrl}&_eventId=detail', 'DETAIL', '800', '700');
    }
}

//chkHead
$(function(){
    $(document).delegate('#ParentCheck','change',function() {
        var chk = $(this).prop("checked");
        var status = 0;
        $("input:[type=checkbox][name^=status_]").prop("checked",chk)
    #foreach($!orderInfoItem in $orderList.orderInfoItemList)
        #if($orderInfoItem.status != '1')
            if(chk){
                $("tr:[id=Row_" + $velocityCount + "]").css("backgroundColor","#ff9");
                status = 1;
            }else{
                #if ($velocityCount % 2 != 0)
                    $("tr:[id=Row_" + $velocityCount + "]").css("backgroundColor","#fff");
                #else
                    $("tr:[id=Row_" + $velocityCount + "]").css("backgroundColor","#dce4ef");
                #end
            }
            $("input:[type=hidden][id^='orderInfoItemList[" + $velocityCount + "]'][id$=checkStatus]").val(status);
        #end
    #end
    });
});

function update() {
//    parent.getObj("ERRORAREA").src="../../layout/error.vm";
    var count=0;
    #foreach($!orderInfoItem in $orderList.orderInfoItemList)
        var checkName = "orderInfoItemList["+$velocityCount+"].orderIdentify.checkStatus";
        if(getObj(checkName)!=null && getObj(checkName).value=="1"){
            count++;
        }
    #end
    if(count==0){
         #set( $mOrderReply = "#customSpringMessage('ORDER_INFO')" );
         alert("#nothingSelectedMessage()");
    }else{
        if( !confirm(checkInfo[0]) ) {
            return;
        }
        parentButtonDisable();
        getObj("BodyForm").action = "${flowExecutionUrl}&_eventId=newConfirm";
        getObj('BodyForm').submit();
    }
}

function allupdate(){
if( !confirm(checkInfo[1]) ) {
            return;
        }
    parentButtonDisable();
    iframeChange("${flowExecutionUrl}&_eventId=newConfirmAll&&infoCd="+parent.document.getElementById("infoCd").value);
}

// いずれかの選択チェックボックスがONの場合
function pageChange(pageNnm, pageno){
    var count=0;
    #foreach($!orderInfoItem in $orderList.orderInfoItemList)
        var checkName = "orderInfoItemList["+$velocityCount+"].orderIdentify.checkStatus";
        if(getObj(checkName)!=null && getObj(checkName).value=="1"){
            count++;
        }
    #end
    if(count!=0){
       if( !confirm("#customMessageArgs("W004","")") ) {
           parent.document.Body.PageNo.value = oldPage;
           return false;
       }
    }
    parent.iframeChange('${flowExecutionUrl}&_eventId=page','pageNow',pageNnm);
    return true;
}
function paging(){
    #if($searchCondition)
        parent.setText("COUNT","#jsEscape($!searchCondition.searchCondition.page.totalRows)");
        parent.setText("PAGECOUNT","#jsEscape($!searchCondition.searchCondition.page.totalPages)");

        parent.document.Body.PageNo.options.length = "#jsEscape($!searchCondition.searchCondition.page.totalPages)";
        for(i=1; i<=parent.document.Body.PageNo.options.length; i++) {
            parent.document.Body.PageNo.options[i-1] = new Option(i,i);
        }
        var pageNow=parseInt("#jsEscape($!searchCondition.searchCondition.page.pageNow)");
        parent.document.Body.PageNo.selectedIndex = pageNow-1;
        parent.document.Body.PageNo.onchange= new Function(" var num=parent.document.Body.PageNo.selectedIndex+1;pageChange(num)");

        #if($!searchCondition.searchCondition.page.hasPreviousPage=="true")
            parent.document.Body.PageFirst.style.display="none";
            parent.document.Body.PageFirstOn.style.display="";
            parent.document.Body.PageFirstOn.onclick = new Function("pageChange(1)");
            parent.document.Body.PagePrev.style.display="none";
            parent.document.Body.PagePrevOn.style.display="";
            parent.document.Body.PagePrevOn.onclick = new Function("var num=parseInt('#jsEscape($!searchCondition.searchCondition.page.pageNow)')-1;pageChange(num)");
        #else
            parent.document.Body.PageFirst.style.display="";
            parent.document.Body.PageFirstOn.style.display="none";
            parent.document.Body.PagePrev.style.display="";
            parent.document.Body.PagePrevOn.style.display="none";
        #end

        #if($!searchCondition.searchCondition.page.hasNextPage=="true")
            parent.document.Body.PageNext.style.display="none";
            parent.document.Body.PageNextOn.style.display="";
            parent.document.Body.PageNextOn.onclick = new Function("var num=parseInt('#jsEscape($!searchCondition.searchCondition.page.pageNow)')+1;pageChange(num)");
            parent.document.Body.PageLast.style.display="none";
            parent.document.Body.PageLastOn.style.display="";
            parent.document.Body.PageLastOn.onclick = new Function("pageChange(#jsEscape($!{searchCondition.searchCondition.page.totalPages}))");
        #else
            parent.document.Body.PageNext.style.display="";
            parent.document.Body.PageNextOn.style.display="none";
            parent.document.Body.PageLast.style.display="";
            parent.document.Body.PageLastOn.style.display="none";
        #end
        oldPage = parseInt(parent.document.Body.PageNo.value);
    #end
}

/**
* 詳細クリック
* param vmorderSeq 注文シーケンス番号
* param vmlastUpdDate 最終更新日時
*/
function openDetail(vmorderSeq,　vmlastUpdDate) {
    parent.iframeChange("${flowExecutionUrl}&_eventId=detailValidate","orderSeq",vmorderSeq,"lastUpDate",vmlastUpdDate,"HIDDENAREA");

}


//check one
function chkData(obj, index){
    var status = 0;
    if(obj.checked == true){
        $("tr:[id=Row_" + index + "]").css("backgroundColor","#ff9");
        status = 1;
    }else{
        if (index % 2 != 0) {
            $("tr:[id=Row_" + index + "]").css("backgroundColor","#fff");
        } else {
            $("tr:[id=Row_" + index + "]").css("backgroundColor","#dce4ef");
        }
    }
    $("input:[type=hidden][id^='orderInfoItemList[" + index + "]'][id$=checkStatus]").val(status);
}
//-->
</script>

</head>
<body id="BODY" class="DataArea" onload="onLoad();setTablefix('#TABLEFIX', 1, 3);">
#if($!errorMessage && $!errorMessage!="")
<div id="error" name="error" class="error">
    $!errorMessage
</div>
#end
<form name="BodyForm" id="BodyForm" method="post">
#foreach($!orderInfoItem in $orderList.orderInfoItemList)
    #customFormHiddenInput("orderInfoItemList[$velocityCount].orderIdentify.checkStatus" "")
#end
#if($!orderList.orderInfoItemList.size() > 0)
<table id="TABLEFIX" class="ListArea" WIDTH="100%">
    <thead>
        <tr id="Header">
            <th class="BoxHeaderCenter FontSmall">No.</th>
            <th class="BoxHeaderCenter FontSmall">#customSpringMessage('DETAIL')</th>
            <th id="CheckCol_H" label="chk" class="BoxHeaderCenter FontSmall">
            <input name="ParentCheck" id="ParentCheck" type="checkbox"></th>
            <th  class="BoxHeaderCenter FontSmall"><img border="0" src="../../image/mrkAttache.gif"></th>

            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.INFO_CD" onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_ORDER.INFO_CD')">
                #customSpringMessage('DIVISION')</th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.ORDER_VERSION" onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_ORDER.ORDER_VERSION')">
                #customSpringMessage('REVISION_NUMBER')</th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.DPO_FLG" onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_ORDER.DPO_FLG')">
                #customSpringMessage('STATUS')</th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.ORDER_NO" onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_ORDER.ORDER_NO')">
                #customSpringMessage('ORDER_NO')</th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.REQ_COMPANY_NAME" onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_ORDER.REQ_COMPANY_NAME')">
                #customSpringMessage('BUYER_COMPANY')</th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.ITEM_NAME" onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_ORDER.ITEM_NAME')">
                #customSpringMessage('ITEM_NAME')</th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.CUST_ITEM_CD" onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_ORDER.CUST_ITEM_CD')">
                #customSpringMessage('ITEM_CD')</th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.KATASHIKI" onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_ORDER.KATASHIKI')">
                #customSpringMessage('KATASHIKI')</th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.ORDER_FIRST_DATE" onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_ORDER.ORDER_FIRST_DATE')">
                #customSpringMessage('ORDER_DATE')</th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.ORDER_DATE" onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_ORDER.ORDER_DATE')">
                #customSpringMessage('CHANGE_ORDER_DATE')</th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.DELIVERY_DATE" onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_ORDER.DELIVERY_DATE')">
                #customSpringMessage('ORDER_DELIV_DATE')</th>
            <th class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.ORDER_VOL">
                #customSpringMessage('ORDER_VOL')</th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.UNIT_NAME" onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_ORDER.UNIT_NAME')">
                #customSpringMessage('UNIT')</th>
            <th label="case" class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.CURRENCY_CD" onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','S_NEW_ORDER.CURRENCY_CD')">
                #customSpringMessage('CURRENCY_CD')</th>
            <th class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.UNIT_PRICE">
                #customSpringMessage('ORDER_UNIT_PRICE')</th>
            <th class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.ORDER_AMOUNT">
                #customSpringMessage('ORDER_AMOUNT')</th>
            <th class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.ORDER_VOL">
                #customSpringMessage('ORDER_CANCEL_VOL')</th>
            <th class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.ORDER_AMOUNT">
                #customSpringMessage('ORDER_CANCEL_AMOUNT')</th>
            #if($!reqUserDispInd == "1" || $!reqUserDispInd == "3")
            <th class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.REQ_SECTION_PLACE_NAME">
                #customSpringMessage('REQ_SECTION_PLACE_NAME')</th>
            <th class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.REQ_SECTION_NAME">
                #customSpringMessage('REQ_SECTION_NAME')</th>
            <th class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.REQ_USER_NAME">
                #customSpringMessage('REQ_USER')</th>
            <th class="BoxHeaderCenter FontSmall" id="S_NEW_ORDER.REQ_USER_TEL_NO">
                #customSpringMessage('REQ_USER_TEL_NO')</th>
            #end
            #if ($!SPNEW031Cooperation.isCooperation())
                #foreach($!cooperationConfig in $SPNEW031Cooperation.Configs)
                    #if ($!cooperationConfig.itemType == "8")
            <th class="BoxHeaderCenter FontSmall" id="$!{cooperationConfig.cooperationId}">
                    #else
            <th label="case" class="BoxHeaderCenter FontSmall" id="$!{cooperationConfig.cooperationId}" onclick="parent.iframeChange('${flowExecutionUrl}&_eventId=order','column','$!SPNEW031Cooperation.getCooperationIdOfSort($!cooperationConfig)')">
                    #end
                    #customSpringMessage($!cooperationConfig.displayItemId)
            </th>
                #end
            #end
        </tr>
    </thead>

    <tbody id="Tbody">

        #foreach($!orderInfoItem in $orderList.orderInfoItemList)
            #if($velocityCount % 2 == 0)
            <tr id="Row_$velocityCount" bgcolor="#dce4ef">
            #else
            <tr id="Row_$velocityCount" bgcolor="#ffffff">
            #end
                <td class="BoxDetailCenter FontList">#set( $no = $velocityCount + 1 )$no</td>
                <td class="BoxDetailCenter">
                    <img id="DetailButton_0" class="Icon" src="../../image/btnDetailDisp.gif" onclick="openDetail('#jsEscapeInHTML($!orderInfoItem.orderIdentify.orderSeq)','#jsEscapeInHTML($!orderInfoItem.orderIdentify.lastUpdDate)');">
                </td>
                <td id="CheckCol_$velocityCount" class="BoxDetailCenter FontList">
                    #if($!orderInfoItem.status=='0')
                        <input type="checkbox" onclick="chkData(this,$velocityCount)" class="Icon" name="status_$velocityCount">
                    #end
                </td>
                <td CLASS="BoxDetailCenter">
                    #if($!orderInfoItem.attachFileFlg == '1')
                        <IMG BORDER="0" src="../../image/mrkAttache.gif">
                    #end
                </td>
                <td class="BoxDetailCenter FontMiniAnkBold" id="division$velocityCount">
                        #out($!orderInfoItem.division_PageValue)
                </td>
                <td class="BoxDetailLeft FontList">
                        #out($!orderInfoItem.revisionNumber)
                </td>
                <td class="BoxDetailCenter FontMiniAnkBold">#out($!orderInfoItem.status_PageValue)</td>
                <td class="BoxDetailLeft FontSlipNo">#out($!orderInfoItem.orderNo)</td>
                <td class="BoxDetailLeft FontList">#out($!orderInfoItem.buyerCompany)</td>
                <td class="BoxDetailLeft FontList">#out($!orderInfoItem.itemName)</td>
                <td class="BoxDetailLeft FontList">#out($!orderInfoItem.itemCd)</td>
                <td class="BoxDetailLeft FontList">#out($!orderInfoItem.katashiki)</td>
                <td class="BoxDetailCenter FontList">#out($!orderInfoItem.orderDate.dateOfymdFormat)</td>
                <td class="BoxDetailCenter FontList">
                    #out($!orderInfoItem.changeOrderDate.dateOfymdFormat)
                </td>
                <td class="BoxDetailCenter FontList">#out($!orderInfoItem.orderDelivDate.dateOfymdFormat)</td>
                <td class="BoxDetailRight FontList" nowrap>
                    <span id="FontList_$velocityCount"></span>
                        $!orderInfoItem.originVol.volFormat
                </td>
                <td class="BoxDetailCenter FontList">#out($!orderInfoItem.unit)</td>
                <td class="BoxDetailCenter FontList">#out($!orderInfoItem.currencyCd)</td>
                #if ($!orderInfoItem.unitPrice.moneyDisp)
                    <td class="BoxDetailRight FontCurrSmall">
                #else
                    <td class="BoxDetailCenter FontCurrSmall">
                #end
                    #out($!orderInfoItem.unitPrice.amountMarkDispForSP)
                    #if($!orderInfoItem.unitPriceDivision == '0')
                        <BR><font class="FontMini" color=red>【#customSpringMessage('PROV_PRICE')】</font><!-- 仮単価 -->
                    #end
                </td>
                #if($!orderInfoItem.orderAmount.moneyDisp)
                <td class="BoxDetailRight FontCurrSmall">
                        #out($!orderInfoItem.originAmount.amountMarkDispForSP)
                </td>
                #else
                <td class="BoxDetailCenter FontCurrSmall">
                        #out($!orderInfoItem.originAmount.amountMarkDispForSP)
                </td>
                #end
                <td class="BoxDetailRight FontList" nowrap>
                    <span id="FontList_$velocityCount"></span>
                        $!orderInfoItem.orderCancelVol.volFormat
                </td>
                #if($!orderInfoItem.orderCancelAmount.moneyDisp)
                <td class="BoxDetailRight FontCurrSmall">
                #else
                <td class="BoxDetailCenter FontCurrSmall">
                #end
                    #out($!orderInfoItem.orderCancelAmount.amountMarkDispForSP)
                </td>
                #if($!reqUserDispInd == "1" || $!reqUserDispInd == "3")
                <td class="BoxDetailLeft FontList">#out($!orderInfoItem.reqSectionPlaceName)</td>
                <td class="BoxDetailLeft FontList">#out($!orderInfoItem.reqSectionName)</td>
                <td class="BoxDetailLeft FontList">#out($!orderInfoItem.reqUserName)</td>
                <td class="BoxDetailLeft FontList">#out($!orderInfoItem.reqUserTelNo)</td>
                #end
                #if ($!SPNEW031Cooperation.isCooperation())
                    #foreach($!cooperationConfig in $SPNEW031Cooperation.Configs)
                <td class="$!SPNEW031Cooperation.getCooperationClass($!cooperationConfig)">
                        #if ($!cooperationConfig.itemType != "8")
                            #out($!SPNEW031Cooperation.getCooperationItem($!orderInfoItem, $!cooperationConfig))
                        #else
                            $!SPNEW031Cooperation.getCooperationItem($!orderInfoItem, $!cooperationConfig)
                        #end
                </td>
                    #end
                #end
           </tr>
        #end

    </tbody>
</table>
#end

</form>

</body>

</html>